---
import type { HTMLAttributes } from 'astro/types';

interface Props extends HTMLAttributes<"div"> {
  tag?: "address" | "article" | "div" | "fieldset" | "figure" | "form" | "footer" | "header" | "ol" | "section" | "ul" ;
  space?: '3xs' | '2xs' | 'xs' | 'sm' | 'md' | 'lg' | 'xl' | '2xl' | '3xl';
  recursive?: boolean;
  splitAfter?: number;
  classes?: string;
}

const { 
  tag = 'div',
  space,
  recursive = false,
  splitAfter,
  classes,
  ...rest
} = Astro.props;

const Tag = tag;
---

<style is:global>
  .stack > * { margin-block: 0 }
  .stack > * + * { margin-block: 0 }

  .stack[data-space="3xs"] > * + * { margin-block-start: var(--space-3xs) }
  .stack[data-space="2xs"] > * + * { margin-block-start: var(--space-2xs) }
  .stack[data-space="xs"] > * + * { margin-block-start: var(--space-xs) }
  .stack[data-space="sm"] > * + * { margin-block-start: var(--space-sm) }
  .stack[data-space="md"] > * + * { margin-block-start: var(--space-md) }
  .stack[data-space="lg"] > * + * { margin-block-start: var(--space-lg) }
  .stack[data-space="xl"] > * + * { margin-block-start: var(--space-xl) }
  .stack[data-space="2xl"] > * + * { margin-block-start: var(--space-2xl) }
  .stack[data-space="3xl"] > * + * { margin-block-start: var(--space-3xl) }

  .stack > *:nth-child(var(--split-after)) {
    margin-block-end: auto;
  }
</style>

<Tag 
  class:list={['stack', recursive && 'recursive', classes]} 
  data-space={space} 
  style={splitAfter ? `--split-after: ${splitAfter}` : ''}
  {...rest}
>
  <slot />
</Tag>